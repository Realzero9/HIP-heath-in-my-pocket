<!DOCTYPE html>
<html>
    <head>
    <!-- 탭 아이콘 -->
        <link rel="shortcut icon" href="../img/1f951.svg" />
    <!-- Required meta tags -->
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Bootstrap CSS -->
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
            crossorigin="anonymous"
        />
    <!-- 타이틀 -->
        <title>Nutrition_4</title>
    <!-- CSS 참조 -->
        <link rel="stylesheet" href="../static/style.css" />
    <!-- 폰트 -->
        <link
            href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&display=swap"
            rel="stylesheet"/>
    <!-- kakaoLogin -->
        <script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
    <!-- file upload -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    </head>
    <body>
        <!-- Navbar -->
        <nav class="navbar navbar-ligth">
            <!-- Navbar content -->
            <div class="container-fluid">
                <ol class="mt-2 breadcrumb">
                    &nbsp;&nbsp;&nbsp;
                    <li class="breadcrumb-item">
                        <button type="button" class="btn btn-secondary btn-sm"><a href="/" style="color: #ffffff">로그인</a></button>
                    </li>
                    <li class="breadcrumb-item">
                        <button type="button" class="btn btn-secondary btn-sm"><a href="#" style="color: #ffffff">음식사진입력</a></button>
                    </li>
                    <li class="breadcrumb-item">
                        <button type="button" class="btn btn-secondary btn-sm"><a href="/his" style="color: #ffffff">히스토리</a></button>
                    </li>
                    <li class="breadcrumb-item">
                        <button type="button" class="btn btn-secondary btn-sm">
                            <a href="javascript:history.back()" style="color: #ffffff">
                                <img src="../img/arrow-left.svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-right" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
                                뒤로가기
                            </a>
                        </button>
                    </li>
                </ol>
                <ol class="mt-2 breadcrumb">
                    <li class="breadcrumb-item">
                        <a href="#0" id="kakaoLogout" class="btn btn-secondary btn-sm">
                            로그아웃
                        </a>
                    </li>
                    <li class="breadcrumb-item">
                        <a href="#0" id="secession" class="btn btn-secondary btn-sm">
                            탈퇴
                        </a>
                    </li>
                </ol>
                <button type="button" class="btn btn-secondary btn-sm">
                    <a href="https://github.com/rlarkdtks312/nutrition_4_team" style="color: #ffffff">
                        영양4조의 GITHUB
                    </a>
                </button>
            </div>
        </nav>
        <center>
            <!-- main content .section -->
            <section class="section">
                <div class="container main-container">
                    <h2 class="title">:: WI-ME ::</h2>
                    <h5 class="subtitle">개인 맞춤형 식단 필터링 성별/나이정보 동기화기반 서비스</h5>
                </div>
            </section><br>
            <!-- main content .section2 -->
            <form method="post" action="/print" enctype="multipart/form-data">
                <section class="section2">                
                    <!-- file upload container-->
                    <div class="container file-upload">
                        <!-- file upload -->
                        <div class="image-upload-wrap" style="width: 45%; margin: 0 auto;">
                            <input
                                class="file-upload-input"
                                type="file"
                                name='img_s'
                                onchange="readURL(this);"
                                accept="image/*"
                            />
                            <div class="drag-text">
                                <img src="../img/upload.png" class="mt-5 pt-2 upload" style="width: 16%;" />
                                <h3 class="mb-5 pd-5 pt-4 upload-text">밥상 위의 <br>음식을 <br> 올려주세요</h3>
                            </div>
                        </div>
                        <!-- file remove -->
                        <div class="file-upload-content">
                            <!-- image view -->
                            <img class="file-upload-image" id="food-image" src="#" alt="your image" />
                            <br><br>
                            <!-- remove button -->
                            <div class="image-title-wrap">
                                <button type="button" onclick="removeUpload()" class="remove-image">
                                    이미지 다시올리기
                                </button>
                            </div>
                        </div>
                    </div><br>
                    <!-- disease select & submit -->
                    <table>
                        <tr>
                            <div id="kakao_account"></div>
                        </tr>
                        <tr>
                            <td>
                                <table class='disease_chk'>
                                    <tr>
                                        <td style="padding: 15px; padding-bottom: 0px;">
                                            <p class="chk_box">
                                                <input type="checkbox" id="chk_top1" name = 'disease' value='비만' checked/>
                                                <label for="chk_top1">
                                                    <span style="color: rgb(255, 255, 255)"> 비만 </span>
                                                </label><br />
                                                <input type="checkbox" id="chk_top2" name = 'disease' value='고혈압'/>
                                                <label for="chk_top2">
                                                    <span style="color: rgb(255, 255, 255)"> 고혈압 </span>
                                                </label><br />
                                                <input type="checkbox" id="chk_top3" name = 'disease' value='당뇨'/>
                                                <label for="chk_top3">
                                                    <span style="color: rgb(255, 255, 255)"> 당뇨 </span>
                                                </label><br />
                                                <input type="checkbox" id="chk_top4" name = 'disease' value='신부전증'/>
                                                <label for="chk_top4">
                                                    <span style="color: rgb(255, 255, 255)"> 신부전증 </span>
                                                </label><br />
                                                <input type="checkbox" id="chk_top5" name = 'disease' value='고지혈증' />
                                                <label for="chk_top5">
                                                    <span style="color: rgb(255, 255, 255)"> 고지혈증 </span>
                                                </label><br />
                                             </p>    
                                        </td>
                                    </tr>
                                </table>
                            </td>
                            <td>
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            </td>
                            <td>
                                <div id="kakao_account"></div>
                                <div class='pt-2 mb-2 submitbutton'>
                                    <input type="submit" class="btn btn-danger" Value='분석' style="width: 300px; height: 100px; font-size: 35px">
                                </div>
                            </td>
                        </tr>
                    </table>
                </section>
            </form>
        </center>
        <!-- scripts -->
        <script>
            // file input script
			function readURL(input) {
				if (input.files && input.files[0]) {
					var reader = new FileReader();
					reader.onload = function (e) {
						$('.image-upload-wrap').hide();
						$('.file-upload-image').attr('src', e.target.result);
						$('.file-upload-content').show();
						$('.image-title').html(input.files[0].name);
					    };
					reader.readAsDataURL(input.files[0]);
				    }
                else {
					removeUpload();
				    }
			    }

			function removeUpload() {
				$('.file-upload-input').replaceWith($('.file-upload-input').clone());
				$('.file-upload-content').hide();
				$('.image-upload-wrap').show();
                
			    $('.image-upload-wrap').bind('dragover', 
                    function () {
				        $('.image-upload-wrap').addClass('image-dropping');
			            });
			    $('.image-upload-wrap').bind('dragleave',
                    function () {
				        $('.image-upload-wrap').removeClass('image-dropping');
			            });
                }
		</script>
        <!-- kakao api script -->
        <script>

            window.Kakao.init('7c081c76ccef59e5002f7e4d0402dcaa');
            window.Kakao.Auth.setAccessToken(JSON.parse(sessionStorage.getItem('AccessKEY')));
            
            function kakaoLogout() {
                if (!Kakao.Auth.getAccessToken()) {
                    console.log('Not logged in.');
                    return;
                }
                Kakao.Auth.logout(function(response) {
                    sessionStorage.clear();
                    alert('로그아웃');
                    window.location.href='/'
                });
            };
    
            function secession() {
                Kakao.API.request({
                    url: '/v1/user/unlink',
                    success: function(response) {
                        console.log(response);
                        sessionStorage.clear();
                        window.location.href='/'
                    },
                    fail: function(error) {
                        console.log('탈퇴 미완료')
                        console.log(error);
                    },
                });
            };
    
            const logout = document.querySelector('#kakaoLogout');
            const sion = document.querySelector('#secession');
    
            logout.addEventListener('click', kakaoLogout);
            sion.addEventListener('click', secession);
        </script>
    </body>
</html>